<!doctype html>
<html>
  <head>
    <style>
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }

      th,
      td {
        max-width: 50px;
        padding: 10px;
        text-align: left;
        border: 1px solid #ccc;
      }

      th {
        background-color: #2b3445;
        font-weight: bold;
        color: white;
      }

      td {
        background-color: #fff;
        color: #333;
      }
      form {
        background-color: white;
        max-width: 600px;
        margin: auto;
        padding: 0rem 2rem 2rem;
        border: 2px solid gray;
        border-radius: 1rem;
      }
    </style>
  </head>
  <body>
    <h3 style="text-align: center">Nation Table</h3>
    <div class="row">
      <div class="col s6" style="padding: 0px !important"></div>
      <div class="col s6" style="padding: 0px !important">
        <div
          style="
            display: flex;
            align-items: center;
            justify-content: end;
            min-height: 53.8px;
          "
        >
          <div>
            <button
              class="modal-trigger waves-effect waves-light btn update"
              data-target="modal1"
            >
              Create New Nation
            </button>
          </div>
        </div>
      </div>
    </div>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <% for( value of nationList) { %>
        <tr>
          <td><%= value.name%></td>
          <td><%= value.description%></td>
          <td>
            <div style="display: flex">
              <button
                class="waves-effect waves-light btn update-one"
                id="<%= value._id%>"
              >
                Update
              </button>

              <button
                class="waves-effect waves-light btn delete-one"
                id="<%= value._id%>"
              >
                Delete
              </button>
            </div>
          </td>
        </tr>
        <% }%>
      </tbody>
    </table>

    <div
      id="modal1"
      class="modal"
      style="width: 600px; background-color: rgba(0, 0, 0, 0)"
    >
      <div class="modal-content" style="padding: 0px">
        <form method="post" id="create">
          <h5 style="text-align: center">Create Nation Form</h5>
          <div class="input-field">
            <input
              id="name"
              type="text"
              class="validate"
              name="name"
              required
            />
            <label for="name">Name</label>
          </div>
          <div class="input-field">
            <input
              id="description"
              type="text"
              class="validate"
              name="description"
            />
            <label for="description">Description</label>
          </div>
          <div style="display: flex; align-items: center; justify-content: end">
            <button
              class="btn modal-close waves-effect waves-light"
              type="submit"
            >
              Submit
              <i class="material-icons right">send</i>
            </button>
          </div>
        </form>
      </div>
    </div>
    <script>
      $(document).ready(function () {
        $(".modal").modal();
        $("#create").submit(() => {
          event.preventDefault();

          var name = $("input[name='name']").val();
          var description = $("input[name='description']").val();
          console.log({ name, description });
          $.ajax({
            url: "/view/nation/create",
            method: "POST",
            data: { name, description },
            success: (data) => {
              console.log(data);
              $("#main").html(data);
            },
          });
        });
        $(".delete-one").click(function (event) {
          event.preventDefault();
          var id = $(this).attr("id");
          if (confirm("Do you want to delete")) {
            $.ajax({
              url: "/view/nation/delete",
              method: "POST",
              data: { id },
              success: (data) => {
                console.log(data);
                $("#main").html(data);
              },
            });
          }
        });
        $(".update-one").click(function (event) {
          event.preventDefault();
          var id = $(this).attr("id");
          $.ajax({
            url: `/view/nation/update/${id}`,
            data: { id },
            success: (data) => {
              console.log(data);
              $("#main").html(data);
            },
          });
        });
      });
    </script>
  </body>
</html>
